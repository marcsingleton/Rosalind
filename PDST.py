"""	Creating a Distance Matrix."""

import os
from itertools import product

import numpy as np
from utils import read_fasta

data = """\
>Rosalind_8423
AGGTTAGCACGCCTGATCGAAGCCTCGATAGCCGAAGGAGGGAGAGCGGGCCTTTAACCA
CAGCTTCTTCTAACTATCGCTATCTAAAGCGCTTAATCAGTGCAAGTACAGAGAAGGGTT
ACGGTTCGAGCTCGCAGCCTTGGCGACGACACACGGGATTTACATTAAGGTCAGAGATGG
ACATTTAAGCGTAGTGCTAGGTGAGGACGTCTCGTTAAGGTAAGAGGCCTCATGGTAGAC
GCCACAAGGCCAGATGATTATTGGGCGCGACGGCCCAAATGCGCAGTGCTCATGTAATTA
TGTGTACTATGCAGTCGATGAGACAACAGCCTCAAATCGCCGAATATCCCGTAACTCTTA
TGGCCGTTAGGTTTCGGCAGAAGTCGGATCAAGCCCCTCCTCGCTTCGATGGAATCCCCG
CCGCATCTACATTTTGCCAACTTGTGTTTACTGCCTTGGTTAAGCTTTATAGTAAGGACT
AGGTTAATCTAGTCCGGATTCGATAAGCTAGTACGTTGTTCTGGGGGTTTTTTACCCGTC
TTTATATTCCGGCTTGTACGCTTCTCTAGGTAATATCAGCTAGTGAGTCTTAGCTCCTTA
GTGGCGCCGTTACAGGCTTCTGGACGAGGTCGTACGCCCTTATACTAAGTTATTCTATTC
ATTTTCTCATGGAAAGCGAAGACGTAGCAGTCCTCACACGGACTTGAGTATGCTCATGCA
GCAGTAGGAAGGGGTGGACACACACACCAAACAGGGGCGAAGAAACCTCACGGTGGAACG
ACAAATATATTTTTTAATAGCAAAGAACAAGCGTGGCCTTGACCAGGGGACCCCCCCGTC
CTTCGATGCAGGTTTCAGTCGTCCAAATAACTGCTGG
>Rosalind_1327
AACGGGCCAGGTCGACTCATATCGTCAGCGGTAGAAGAAAGAATCGCTGTCCTCTAGAGA
TAACTTCCTCTAGCCACTGCTATCTAAGGGGTACAGTTAATTGACGTGTGAAAAAGGGAA
ACACTTGCTTGGCGAAACCCCGGCGTTCAGAGAAAGGTTCCGCTTGTGGCGTGCCGGTCG
GGCGCAAGACAGCGTGTTAAGTACATTCGTCGTATGCCCGTGGAAGATTAAGCAAGAGTC
ACCAAATGATCAGGACGCCCTTAGTCGTAACCATCTCTAAATTTATTCCGCGCCCGGTGG
CGAGGATTCTCAAGTCCACAAGATGGTAACGTCTGAATGATACATGCCGATTGATTCTCC
CAGCTGATAGATGCCTATGTCACATACGTTCCCTCGCGGGTGACTTACATACAGGCATCC
ATACACTCGCTATTTACTAGTCACCGTCTGTTCCCGTGGCATGATTTAATTAGAATTATA
ATAATGACTTGCTTCGAAACTAGAATGCCCGCTAGTTCCTCCGAGATTTCGGCATTGGTT
GACGCAATACTACATGCGTGTTTGTCTCTGTGGGATCAATCTCGTTACTGGGATACAACT
GTGGGAGCCTTACAGACGACTGGTCCGGGCTATACGCTCCTAGTTCGGGCTGGGGCTCGG
GCTTTCTTGCGGGTGGGAAGGACCTAATAACCATTATGCTGATCTAGATGTAGTCATGTA
AGAGTACGTATTGACGTAGGCGTGCACCAAGTTGGTGCAAAATGACCTTATGGCGTAGTT
AAGTACATTCTCTGCCACCCCAGGAAGCTTGAGAGGCAGTAGTTAGGGTATCTTATGACT
CCTCGATATAAGCCTTAATAGTTTAGACGATCGTTGA
>Rosalind_3938
CATGGGCCAGGCCGACTTATCTCGTCTACGGCCGAAAAAAGGATCGCTGTCTCCTAGCAA
TGACTTCTTCGAGCCGCTGCTGTCTGGGGGGCATGTCCAATTGACGTGTCAAAAGGAGAA
ACACATGTTCGGCGAGACCCCGGTATCCAGGGATAAGTTCCACCCGTGGCGGACCGCCCG
GGTGCAAGAAATCGTATTAAATACATCCTACGTATGCCCTTAAAGCATTAAGTAAAACCG
ACCGAAAGGTTGGAATGCACTTAATTGCTAACATCAGTAAATCTATTTCGCGTCCGGCGG
CGGGGATTTTTATGTACTGAAGTCGGTAGTGCCCGGATGATATGCACAGATTAATTCTCC
CAGCTACCCGACCTCCATGGCGTAGACGTTCCCTCACGGGCGATTTATAAGCAAGCATCC
ATACAACCGCTATCTGCTGACCATCGTCTTTTCACCTGAGGCAATTCGACCGGGGCTATG
GTAATGAATCACTTCGAATTTAAAATGTTCGCCAGTTACTGCGTAATAGCGGCATTGGTC
CGCGATTTACTGCGTGGGGGTTTGTCACCGTGAGGACGGTCTCGGCACTGGGACACAACC
GTGGGAGAGTTTCAAACGACTCATCCGGGCTACACGGTCCAAGATCGGGCTCAGGCACGA
GCTTCGTCGTCAGCGTAGAGAAGCTAGTAACCATTCTGCAGACCTTGATTTGGTCACCTA
AGAGTGTGCACCAGCGCAAGACATCATCTGGACGGTGTATAACAGTCTTATGGCGTAGTT
GATTGTAACGCTTGCCACCTTAGGAAGCTCAAGGAGCGATGTTAAGTGTGTCATATGACT
CGTCAACATGAGCCTTGACAATTTTGACGACCGTCGA
>Rosalind_6315
GACGCATCACGCCTGGTTGTGGATTTAACAATCGAAGGACAAAGTGCAGGCTTTTAAATA
CTGCCTGCTCCGACCAATGCTATCTAAGGAATTGAACTAATAGAGGTGCGGATTAGAAAT
ATACTTCTTCAGCGTCGTTCCAGGGCCGCGAGAGGGAGTTCGCACATGAGTTAAGGACGG
GCTTTTAAAAAAAGCGCTAGTTGAGGGCGTTACGTTATTGTGGAGGGCCAAACCGAAGGC
GTCACAGACATGAATAAGCATTAGGTTTAACCCTCCTGCTGCCAAGTGCATGCGGGATAA
TGTGTATCATGCTCTTGACGGAGTGCCAACACTGGGATACCGCATATCGTCTAGTTCTAC
GGACCGCTAGATATCGCCAGTACTATTATCACGTCCCCACTCGTTCCGATAGAATCATTC
CCGCATCTTCGTCTTATTAGCAGACGTTAACACTCTTGGTCTGTCTTTGGTATGTGGTCG
AGGCAAATCTTACCTAAAGTGGCTAAGTTAGTTTGTTGTTCAGGGCATCCTTCACTTGTC
TACGTATTCCAGCCTGCACGCCACTCTCCATAACATCACCTGGCGTTCCGTGACGCAGAA
GTGGAGCCTATGCAAGCTCCTGGTCGAGGTTGTACGGCTGTACACAGAGACGAAATCTAC
GCTTTTTAATGGGTAGAGATGGCGTGGAAATCATAAGGGGAACTTGGGTGCACCCATGTA
GCGGCGGAAGAGGGTACATACACGCACCAAATAGAGTCGGAATAGTCCTACGATGGCACA
AAAGATACACCCTCTTGTTACAATAAGCAAGTAAAGCTGTTATTGCGGCACCTCCCCGCT
CCACGATATGTGCTCCAATAGCGGAGACGGTTGTTTA
>Rosalind_4501
AACGGGACTGGATAACTCAAATAGTCAGCGACAGAGGAAAGGACAATTTTTGCCTAGAGA
GAGCTTTCACCAGCCCCTGCTGCCTAAAAGATACAGTTAAATGACGCGGAACGGAGAAAA
ACACTCGCTTGGCGGGATCTCGGGGTTCAAAGAGAGGATGCGTCTGTAGCTTACCGGAGG
GGCGCAAGAAAGCGCGTTAGGTGCACTCAACATACATCTGAAGAGGATAAAGCAAGGATC
ACCAAATGGTCAGAACGCCCTTACTCGAAACTAGCTCCAGAGTTATTCTACGCCAGGTCA
CAATGATTTTCCAGTCTACAGGACGGCGATGATCGGATGTTAACTGCCGGTTAGCTCCCC
CGCCTACTAGACGCCAATAACGCATGCCCTCCTCCGCAAGCAGTTCACATGCAAGCATTT
ATAGACTTACTACTTTCTAGCCACCGTGTCTGTTTGTAGCATGGTTAAGTTAGAGATATA
CGAATAAATTGCTTTAATAGCGAGATGCTCGGCAGTCTATATGACTCTCCAGCCTTGGAC
GGGGCGACACTACATGCGTGTCTATTTCTGTGGGATAAATTCCGTTTTTCGAATACAACG
GTGAGCGCCTTACATACGACTGGTCCCGGTTACATGATCTTAATTCGAGGTAGAACTCGG
ACTCCCATGTGGGAGGGCAGAATCCGGAAGCCATCACTTTGGCCGAGACATAGACGGCTA
TAGGGATGTACCGACATAGGCGTTTACCGAGTGGGCGCGCAGTGACCTTGTGGCGTGGTT
AAATACATCCTCCGTCCTCCTGAGGGGCATGAAAGGTGGTAGTCGGGGTATCGGCTGAAA
GCTCGATCTGAGCTTTGGTAATCTAGACGGCCTTTGT
>Rosalind_6894
AAATTAGTACGCCCGACCCAAATCTCGATGGCCGGGAGGGGGGGGGCAGGTGCTTAGCCC
TAGCTTTTTCTGCTAATTGCTAGCTGAAGCGCTGCATCATCACAAGTATGACGAGGGGCC
ATGATTCGGGGCCTCTGCCCCGGTAACGACATACGAGGTCTGTGGTAAGGTCAAGGACGA
ACCTCTAAGGGCAGTGCTCCGTAAGGAAGTTTCGTTAAGGTGATAGGCCCACCAGTGGAC
ACCACAAAGCCAAGTGTACGCTGGACGCGGTGGATTGGTTTCGCAATGCTCACCCAACGA
CGTGTACCATGCAATCGAGAAGGCAGCTTCCCCTAACCGCCGCATGTTCGGTAACGCTTA
AGGGCGTTGAGTTTAGGCGGAAGTCGAGTCAAGCCTCTCTCCGTTTCGATGGAGCCTCTG
CCGCACCTGTATTTTACCAGCTCCTGTCGATTGTCTAAGTTAACGTTTCAAATGAGGTCT
ATATTAATGTAGTCTGGATCCGATAGGCCAACGCGTTATTTAGGCACTTCTATACACCTT
TTCATTGTTCGACTTATACACTGGTTCAGGTGGTCTCGGCTAGTGCGTCTTTACACGTTG
GAGGCCCTGTCATGAGCATCTGGGTGAGACCGTGCGCTCTCATGCTCGGTTGTTGTAACC
ATTTCCTAATCAGAAATGAGGACGTAACAGGTCTCGTACGGGCATAAGTACACTCATGCG
GCGGTAGGGATGGCTAGACGCATCGAAAAGACAGACGTGCAGAAAGCCTTTGGTAACACG
AAGAACATGTCTTTTGACAGCAGAGGATAGGCATGGCTACAACCCGAGAGCCTCCTTGAC
TTTCAAAGCAGGCTCCAATCGCCCAAACAACTGCTTA
>Rosalind_5644
GGGCTAGCACACCTGGTCGAAGGCTTGTTAGTCAAGGGAGGGGGAGAGGGTCTCTAACCA
CAGTTTCCTTTAACTATTACTATTTAAAATGCTTAGTCAGTACAAATGCAGGAAAAGGAT
ACAGTCCGCGCTCATAGCCCTGACGATTTGACATGGAATTTGCGTTTAAGCCGGAGATTG
ACGTTTAAATGTAGTGTTAAGCGAGGACGCCCCGCTGAAGTAGAGGGTCTCATTATAGGT
GCCAGAAAGCTAAGTTATTACTGGTCGAGACGGTTTAATACCGCAGAGTTCACTTGATTA
CGTGTGTTATGTAGTCAATGAAACACCAGACTCGAACCCCCGAATATCTAGCAATTCTAA
TGGCCGTTAGATTCGGGAAGAAGTTGCACTAAGCCCCCGTCCGCTTAAAAGACATCATGG
CCGCAACCACATTTTACCAAGTTGTGCCCTCTGTCCTGATTTAAGTTTTTAGGATGGAAA
CCGCCAATCCGATCCGGAACCAATGCGCTAGTATTTTGTTCTGAGAGTTTAGTACCCGCC
TTTATACTCCGACCTGTGCGCTTCTTCAAGTAATATCAGTCTGTGAGCGCTAGTTTACTG
GTAGCGCTGAAGTAAGCTTCTGGACGAGGTCGCGCGTTCGTATAGTGAGTCAGTCTGTTA
ATTTTCTCGAGGAAACCGAAACCGTAGTAATCCTCACGCGTGCTTCGGTATCCCCATATA
ACATCAGAAAAGGATAGACTTTATCAACTAACCGGGGCGACAGAATCGTGCAGTGGAACG
CCAAATATATTTTTCTTTGGCAAGGAACAGGAGTGACATTGGCTAGGGAGCCCCCCCGTC
TTTTGATGACGGTTTTAGTCGTCTCAGCAGCTGTAGG
>Rosalind_7110
AACGAGCCGTGTCGACTTAAATCGTTGACGGCCGAAAGATGGATTGCAGGCTTCTAGTTA
CAGTTCCTTCTAACCGCTGCTATCTAAGGGGTTGAGTTAATTGAGGTGCGAATGAGGAAG
ACACTTGCCTGGAGAGACCCCAGCGTCCAGGAGAGGGCTCCACTTGTGGCTTAACGCCGG
GGCTGAAGACAACGTGCTAAGTATATGCGTCACATGGTGGCGAAAGGCTAAGCAAGGGGC
GCGGTATGATTAAGACGTTCTTAATCGTCATTATTTTTATATTTAGTTCACGCGCGGTAA
CGAGGATTGTGAAGTCGACGAAACGACAACGTGTGAGTGAAACATGCCAATTGATTCTCC
CAACTGATAGATGTTCATATCACTTTTGTTTCTCCGCTGTTGGCTCATATAAAGGCACCC
CTACACCTGCATTTTACTAGTTAGCGTCTATTTTCGTCGTTTAACTTAATTATAAGTATA
GGAATAGCCTGCTCCGAAATTGAAGAGCCCGCTAGTTTTTCCAGGTTTTTGCCATTGGAC
TACGCACTCCTACGCATATGCTTGTCTCTGTGGGATTAATTCCAGTACTGGGATGCACGA
GTGGAACCTTTACAATCGACCGGTTGGGGCAATACGTTTCTACCCCGAGTTAGGGCTCGG
GCTTTCTTGTGGGTAGTAAGGACATGATAGCCACTACGCGGACCTAAATGTAGTCATGTA
GGAGTAGGGGGGGGCGGACGTGCGTACCAAGTAGGTGCAAAGTGGTCCCACAGTGTAATT
AAATACATTCCCTCTTACTGCAAGCAGCTGGTGAAACTGTTGTCAGGGTACCTTGTCGTC
CCTCAATATAGGCCCCGATAGTTTGGACGGTTGTTAG
>Rosalind_2410
AACGTATCACGTCTGATTGAAGCTTTAACGGTCGAAGGACGGAATGCAGGCTTCTAATTA
CAGCTTATTCTAACTAGTGCTATCTAAGGGGTTGAATTAATAGAGGCACGGATGAAAAAT
ATGCTTCCTCAGCGTCGCCCTAGCGTCGAGGAAAGGGATTCACATATAGGTTAAGGATGG
ACCTCTAAGCGAAGTGCTAGGTGAGGGCGTTCCGTTATGGTGAAAGGCCGAACCGAAGGC
GCCACAAGGCTAGAGAGTTATTAAGCGTAACCTCCCAGATACTCAGTGCACGTGTGATAA
TGTGGACTATGCAGTTGATGGAACGACAACGCTGGAATGCAGCATACCACCCAATTCTTC
CGACTGCTAGATATCGGTAGCACTTTTATCACCCCTCCACTCGTTTTGATGAAATCATCC
CCGCACCTGCATTTTATTAGCTGGTGTTAACTTTCATGGTCCAACTTTATTATAAGAATG
AGGTTAATCTAATCCAGAATGGATAAGCCAGTTCGTTGTTCTGGGCGTCTTTTACCCGTT
TACATACTCCAGCTTGTACGCTTCTCTCTGTGGTATTAACTAGTGTGCCGTGACGCACAA
GTGGAACCTTTACAAGCGCCTGGTCGGGGTTGTACGCCTCTACACTGAGTCAGGATTCAC
GCTTTCTTATGGATAGCAAAGACGTAGCAGTCACCACGCGGACCTGAGTGTGCTCATGTA
GCGGCAGGAGGGGGTGAACGTGCGCGCCAAGTAGAAGCGAAGTGACCCTACGGTGGAACG
AAAAATATATTCTCTTATCGCAAACAGCAAGTAAAGCTGTTATCAGAGCACCTCCTCGTC
CCTCGATACAGGCTCCAATAGTTCGGACGGCTGTTTG
"""

data_path = 'PDST.txt'
with open(data_path, 'w') as file:
    file.write(data)

fasta = list(read_fasta(data_path))
indices = {seq_id: index for index, (seq_id, _) in enumerate(fasta)}

array = np.zeros((len(fasta), len(fasta)))
for (seq_id1, seq1), (seq_id2, seq2) in product(fasta, fasta):
    i, j = indices[seq_id1], indices[seq_id2]
    equal = [sym1 != sym2 for sym1, sym2 in zip(seq1, seq2)]
    pdist = sum(equal) / len(equal)
    array[i, j] = pdist
    array[j, i] = pdist

for row in array:
    print(' '.join([str(value) for value in row]))

os.remove(data_path)
